SD_1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_2=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_3=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_4=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_5=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_6=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_7=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_8=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_10=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_11=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_12=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_13=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_14=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_15=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_16=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_17=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_18=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_19=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
SD_20=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
Lenght=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
l1=75.326;l2=72;Zmax=l1+l2;
a_max=55;b_max=115;c_max=90;%关节最大角度 


%在进行踏步前，robot要进行Z轴下降0.6cm 降低低重心X轴前移0.8cm
%准备动作用时0.5s
%*********ready*********%
time=0.5;%准备用时时间
[c0,c1,c2,c3]=orbit_function(time,0,3);%轨迹规划参数
t=linspace(0,time,10);
height=147.3-(c0+c1*t+c2*t.^2+c3*t.^3);
[a0,a1,a2,a3]=orbit_function(time,0,0);%轨迹规划参数
deepth=a0+a1*t+a2*t.^2+a3*t.^3;

syms x y
for i=1:10
eqns=[l1*sin(x)-l2*sin(y)==deepth(1,i),l1*cos(x)+l2*cos(y)==height(1,i)];
vars=[x y];
[solx,soly]=solve(eqns,vars);
SD_2(1,i)=abs(vpa(solx(2,1)*180/pi,2));
SD_4(1,i)=abs(vpa(soly(2,1)*180/pi,2));
SD_2(1,i)=roundn(SD_2(1,i),-1)+3;
SD_4(1,i)=roundn(SD_4(1,i),-1);
SD_3(1,i)=SD_2(1,i)+SD_4(1,i);
SD_4(1,i)=SD_4(1,i)+3;
SD_7(1,i)=SD_2(1,i);
SD_8(1,i)=SD_3(1,i);
SD_9(1,i)=SD_4(1,i);
end
T=2;%踏步周期2s
t=linspace(0,T,80);
w=2*pi/T;%角速度
Y=25*sin(2*pi/T*t);% 中心点位移 
plot(t,Y);
%抬脚高度计算
time=1;%下蹲所需时间
[c0,c1,c2,c3]=orbit_function(time,0,10);%轨迹规划参数
t=linspace(0,time,20);
Lenght_2=height(1,10)-(c0+c1*t+c2*t.^2+c3*t.^3);
syms u lenght
for i=1:20
 %求解二元一次方程组
 %deepth是固定不变  踏步的时候机器人运动轨迹在对其y轴
 %而对Z轴高度其实要求严格，但是要保证LENGYH固定
eqns=[lenght*sin(u)==Y(1,i),lenght==height(1,10)];
vars=[lenght,u] ;
[solt,solu]=solve(eqns,vars)
Lenght(1,i)=abs(vpa(solt(1,1),2));%长度
Lenght(1,i)=roundn(Lenght(1,i),-1);
SD_1(1,10+i)=abs(vpa(solu(1,1)*180/pi,2));
SD_1(1,10+i)=roundn(SD_1(1,10+i),-1);
if SD_1(1,10+i)>60
    SD_1(1,10+i)=180-SD_1(1,10+i);
end
SD_5(1,10+i)=SD_1(1,10+i);
SD_6(1,10+i)=SD_1(1,10+i);
SD_10(1,10+i)=SD_1(1,10+i);
SD_7(1,10+i)=SD_7(1,10);
SD_8(1,10+i)=SD_8(1,10);
SD_9(1,10+i)=SD_9(1,10);
%抬脚
eqns=[l1*sin(x)-l2*sin(y)==deepth(1,10),l1*cos(x)+l2*cos(y)==Lenght_2(1,i)];
vars=[x y];
[solx,soly]=solve(eqns,vars);
SD_2(1,10+i)=abs(vpa(solx(2,1)*180/pi,2));
SD_4(1,10+i)=abs(vpa(soly(2,1)*180/pi,2));
SD_2(1,10+i)=roundn(SD_2(1,10+i),-1)+3;
SD_4(1,10+i)=roundn(SD_4(1,10+i),-1);
SD_3(1,10+i)=SD_2(1,10+i)+SD_4(1,10+i);
end
for i=1:20
    SD_1(1,30+i)=SD_1(1,30-i);
    SD_2(1,30+i)=SD_2(1,30-i); 
    SD_3(1,30+i)=SD_3(1,30-i);
    SD_4(1,30+i)=SD_4(1,30-i);
    SD_5(1,30+i)=SD_5(1,30-i); 
    SD_6(1,30+i)=SD_6(1,30-i);
    SD_7(1,30+i)=SD_7(1,30-i);
    SD_8(1,30+i)=SD_8(1,30-i); 
    SD_9(1,30+i)=SD_9(1,30-i);
    SD_10(1,30+i)=SD_10(1,30-i);     
end
for i=1:20
    SD_1(1,50+i)=0-SD_6(1,50-i);
    SD_2(1,50+i)=SD_7(1,50-i); 
    SD_3(1,50+i)=SD_8(1,50-i);
    SD_4(1,50+i)=SD_9(1,50-i);
    SD_5(1,50+i)=0-SD_10(1,50-i); 
    SD_6(1,50+i)=0-SD_1(1,50-i);
    SD_7(1,50+i)=SD_2(1,50-i);
    SD_8(1,50+i)=SD_3(1,50-i); 
    SD_9(1,50+i)=SD_4(1,50-i);
    SD_10(1,50+i)=0-SD_5(1,50-i); 
end
for i=1:20
    SD_1(1,70+i)=SD_1(1,70-i);
    SD_2(1,70+i)=SD_2(1,70-i); 
    SD_3(1,70+i)=SD_3(1,70-i);
    SD_4(1,70+i)=SD_4(1,70-i);
    SD_5(1,70+i)=SD_5(1,70-i); 
    SD_6(1,70+i)=SD_6(1,70-i);
    SD_7(1,70+i)=SD_7(1,70-i);
    SD_8(1,70+i)=SD_8(1,70-i); 
    SD_9(1,70+i)=SD_9(1,70-i);
    SD_10(1,70+i)=SD_10(1,70-i); 
end





% USART.port='COM4';
% USART.PropertyName='BaudRate';
% USART.PropertyValue=128000;
% obj=serial(USART.port,USART.PropertyName,USART.PropertyValue);
